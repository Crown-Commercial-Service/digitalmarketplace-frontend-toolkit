{% if hint %}
  {% set answer_advice_id="input-" + name + "-answer-advice" %}
{% endif %}
{% if question_advice %}
  {% set question_advice_id="input-" + name + "-question-advice" %}
{% endif %}

{% if error %}
  <div class="validation-wrapper">
{% elif message %}
  <div class="message-wrapper">
{% endif %}
  <fieldset class="question first-question{% if inline or type=='boolean' %} inline{% endif %}" id="{{ name }}">
    <legend>
      <span class="question-heading">
        {% if question_number %}
          <span class="question-number">
            {{ question_number }}
          </span>
        {% endif %}
        {{ question }}
      </span>
      {% if error %}
        <span class="validation-message" id="error-{{ name }}">
          {{ error }}
        </span>
      {% elif message %}
        <span class="message-content">
          {{ message }}
        </span>
      {% endif %}
    </legend>
    {% if optional %}
      <span class="question-optional">
        <strong>Optional</strong>
      </span>
    {% endif %}
    {% if question_advice %}
      <span class="question-advice" id="{{ question_advice_id }}">
        {{ question_advice }}
      </span>
    {% endif %}
    {% if hint and not hint_underneath %}
      <span class="hint" id="{{ answer_advice_id }}">
        {{ hint }}
      </span>
    {% endif %}
    {% if type == "boolean" %}
      {% set default_yes = true if value is sameas true %}
      <label class="selection-button selection-button-radio{% if followup %} block-label{% endif %}{% if default_yes %} selected{% endif %}" for="input-{{ name }}-yes" {% if followup %}data-target="{{ followup }}"{% endif %}>
        Yes
        <input
          type="radio"
          name="{{ name }}"
          id="input-{{ name }}-yes"
          value="true"
          {% if question_advice or hint %}aria-describedby="{{ [question_advice_id, answer_advice_id]|join(' ') }}"{% endif %}
          {% if default_yes %}checked="checked"{% endif %}
        />
      </label>
      {% set default_no = true if value is sameas false %}
      <label class="selection-button selection-button-radio{% if default_no %} selected{% endif %}" for="input-{{ name }}-no">
        No
        <input
          type="radio"
          name="{{ name }}"
          id="input-{{ name }}-no"
          value="false"
          {% if question_advice or hint %}aria-describedby="{{ [question_advice_id, answer_advice_id]|join(' ') }}"{% endif %}
          {% if default_no %}checked="checked"{% endif %}
        />
      </label>
    {% else %}
      {% for option in options %}
        {% set input_value = option.value or option.label %}
          {% if type == "radio" %}
            {% set default_selected = (input_value == value) %}
            <label class="selection-button selection-button-radio{% if default_selected %} selected{% endif %}" for="input-{{ name }}-{{ loop.index }}">
              {{ option.label }}
              <input
                type="{{ type }}"
                name="{{ name }}"
                id="input-{{ name }}-{{ loop.index }}"
                value="{{ input_value }}"
                {% if question_advice or hint %}aria-describedby="{{ [question_advice_id, answer_advice_id]|join(' ') }}"{% endif %}
                {% if default_selected %}checked="checked"{% endif %}
              />
          {% elif type == "checkbox" %}
            {% set default_selected = (value and (input_value in value)) %}
            <label class="selection-button selection-button-checkbox{% if default_selected %} selected{% endif %}" for="input-{{ name }}-{{ loop.index }}">
              {{ option.label }}
              <input
                type="{{ type }}"
                name="{{ name }}"
                id="input-{{ name }}-{{ loop.index }}"
                value="{{ input_value }}"
                {% if question_advice or hint %}aria-describedby="{{ [question_advice_id, answer_advice_id]|join(' ') }}"{% endif %}
                {% if default_selected %}checked="checked"{% endif %}
              />
          {% endif %}
          {% if option.description %}
            <p class="question-description">
              {{ option.description }}
            </p>
          {% endif %}
        </label>
      {% endfor %}
    {% endif %}
    {% if hint and hint_underneath %}
      <div class="hint-underneath" id="{{ answer_advice_id }}">
        {{ hint }}
      </div>
    {% endif %}
  </fieldset>
{% if error or message %}
  </div>
{% endif %}
